<!DOCTYPE html> <html lang="en"> <head> <title>PicketLink</title> <meta charset="utf-8"/> <meta content="width=device-width, initial-scale=1.0" name="viewport"/> <link href="http://picketlink.org/css/bootstrap-community.min.css" media="screen" rel="stylesheet"> <script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script> </link> <link href="http://design.jboss.org/picketlink/logo/images/favicon.ico" rel="shortcut icon"/> <style type="text/css">
      /*<![CDATA[*/
        @media (min-width: 980px) {
          .banner { background-image: url(http://www.jboss.org/dms/picketlink/images/picketlink-banner-1180px.png); background-repeat: no-repeat; height: 110px;  }
        }
        @media (max-width: 979px) {
          .banner { background-image: url(http://design.jboss.org/picketlink/logo/images/picketlink_logo_600x.png); background-repeat:no-repeat; height: 60px; }
        }
        @media (max-width: 650px) {
          .banner { width: 500px; margin: 0px auto; }
        }
      /*]]>*/
    </style> <script src="http://static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.min.js"></script> <link href="http://picketlink.org/stylesheets/blog.css" rel="stylesheet" type="text/css"/> <link href="http://picketlink.org/stylesheets/asciidoctor-coderay.css" media="screen" rel="stylesheet" type="text/css"/> <link href="/stylesheets/sh/shCore.css" rel="stylesheet"/> <link href="/stylesheets/sh/shThemeDefault.css" rel="stylesheet"/> <link href="/stylesheets/sh/SyntaxHighlighter.css" rel="stylesheet"/> <style type="text/css">
      /*<![CDATA[*/
        td.download-size {
          text-align: right;
          padding-right: 10px;
        } 
        
        .white-stripes tr:nth-child(even) {
          background-color: white;
        }
        .white-stripes tr:nth-child(odd) {
          background-color: none;
        }
      /*]]>*/
    </style> </head> <script src="/javascripts/sh/shCore.js"></script> <script src="/javascripts/sh/shBrushJava.js"></script> <script src="/javascripts/sh/shBrushXml.js"></script> <script src="/javascripts/sh/shBrushBash.js"></script> <script type="text/javascript">
    //<![CDATA[
          SyntaxHighlighter.defaults['gutter'] = false;
          SyntaxHighlighter.defaults['toolbar'] = false;
          // register a listener for when the highlighter is done with replacing elements
          SyntaxHighlighter.all();
    //]]>
  </script> <body> <ul class="visuallyhidden" id="top"> <li> <a accesskey="n" href="#nav" title="Skip to navigation">Skip to navigation</a> </li> <li> <a accesskey="c" href="#page" title="Skip to content">Skip to content</a> </li> </ul> <div class="container" id="content"> <div class="dropup"> <a class="tabnav-closed" href="https://www.redhat.com" id="tab">Red Hat</a> </div> <div class="banner"> <a href="http://picketlink.org"></a> <div class="taglinedark visible-desktop"></div> </div> <div class="navbar navbar-inverse" id="navbar-fix"> <div class="navbar-inner"> <div class="container"> <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </a> <div class="nav-collapse collapse"> <ul class="nav" id="nav"> <li class=""><a href="http://picketlink.org/">Home</a></li> <li class=""><a href="http://picketlink.org/about/">About</a></li> <li class=""><a href="http://picketlink.org/news">News</a></li> <li class=""><a href="http://picketlink.org/gettingstarted/">Getting Started</a></li> <li class=""><a href="http://docs.jboss.org/picketlink/2/latest/reference/html/">Documentation</a></li> <li class=""><a href="http://picketlink.org/gethelp/">Get Help</a></li> <li class=""><a href="https://github.com/picketlink/picketlink">Source Code</a></li> <li class=""><a href="http://picketlink.org/testimonials/testimonial/">Testimonials</a></li> <li class=""><a href="http://picketlink.org/joinus/">Join Us</a></li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#">Follow Us <b class="caret"></b></a> <ul class="dropdown-menu projectsocialmedia"> <li><a href="http://twitter.com/picketlink"><img src="http://static.jboss.org/theme/images/common/socialmedia_icon40_twitter.png"/></a></li> <li><a href="https://plus.google.com/communities/101791570551871936976"><img src="http://static.jboss.org/theme/images/common/socialmedia_icon40_googleplus.png"/></a></li> <li><a href="http://facebook.com/picketlink"><img src="http://static.jboss.org/theme/images/common/socialmedia_icon40_facebook.png"/></a></li> </ul> </li> </ul> </div> </div> </div> </div> <span id="page"></span> <div class="row-fluid"> <div class="row-fluid"> <div class="span12 well post-bg"> <div class="row-fluid"> <div class="span12"> <h2>Identity Management Overview</h2> <p> This guide will show you how to use the PicketLink Identity Management API to manage identity data such as partitions, users, roles, groups, credentials, attributes and so forth. It will cover some core concepts and make it easier for you to understand how those concepts are applied in a project. </p> <p> The first thing you should know about PicketLink IDM is that you can use it in Java SE the same way you use it in Java JEE. The main difference between those platforms is how components are exposed to your application and the built-in capabilities provided by one over another. </p> <p> In Java JEE, PicketLink provides a rich and flexible CDI Extension, making a lot easier how you use the IDM API. Main components such as <code>PartitionManager</code> and <code>IdentityManager</code> are available for injection with a default configuration so you can start using them very quickly to manage your identity data. But in essence the IDM API is based on Java SE, what means you can use it in any Java-based project. </p> <p> This guide will show you how to add the following capabilities to your application: <ul> <li>Partition Management</li> <li>IdentityType Management</li> <li>Relationship Management</li> <li>Credential Management</li> <li>Attribute Management</li> <li>Configuration Overview</li> </ul> </p> <p> We strongly recommend you to take a look at the <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Overview">Identity Management Overview</a> section of the documentation. </p> <p> This guide is based on some example applications provided by our <a href="https://github.com/jboss-developer/jboss-picketlink-quickstarts">quickstarts.</a> Check the README.md file for each quickstart for more details about how to use them. </p> <p> You can also check the <a href="../first_cdi_app">First PicketLink CDI Application Guide</a> for more information about how to create a simple application. </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Identity Model</h3> <p> The <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#sect-Identity_Model">Identity Model</a> is a set of classes that define the security structure of an application. In a nutshell, those classes will be used to represent your identity data and store it using the PicketLink IDM API. Most applications have their own set of classes and interfaces to represent users, roles, groups, permissions and so on. That is what the Identity Model is all about where PicketLink provides an abstract and flexible model from which you can create your own representations. </p> <p></p> <img src="http://docs.jboss.org/picketlink/2/latest/reference/html-single/images/5858.png" width="600px"/> <p> In order to help users to start using PicketLink with the minimal effort, PicketLink provides a <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Basic_Identity_Model">Basic Model</a> based on some very common use cases. This model provides a specific representation for users, groups, roles, partitions, permissions and relationships like grants and group memberships. You can use it directly in your project or even use it as a template for your own model. That said, you're not forced to use the Basic Model in order to use PicketLink IDM. For more details about how to provide your own model, check our <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#sect-Creating_a_Custom_Identity_Model">documentation.</a> </p> <img src="http://docs.jboss.org/picketlink/2/latest/reference/html-single/images/5850.png" width="600px"/> <p> Understand the PicketLink Identity Model is crucial to use all that PicketLink IDM has to offer. Try to spend some time looking how the Basic Model was built to understand more how you can extend PickeLink IDM to better fit your requirements. </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Managing Partitions</h3> <p> PicketLink has been designed from the ground up to support a system of partitioning, allowing the identity objects it manages to be separated into logical groupings. Partitions may be used to split identities into separate realms, allowing an application to serve multiple organisations (for example in a SaaS architecture) or to support a multi-tier application allowing each tier to define its own set of identity objects (such as groups or roles). PicketLink's architecture also allows you to define your own custom partition types, allowing more complex use cases to be supported. </p> <p> When managing identity data, every single operation is executed in the scope of a partition. By default, PicketLink creates a <b>default</b> partition for your application during startup, so you can start managing your data using a single partition. If you're using the Basic Model (as discussed previously), partitions are repesented by the <code>Realm</code> type. </p> <p> Partitions are managed by the <code>PartitionManager</code> interface. You can inject an instance into your beans as follows: </p> <pre class="brush: java;">&#x000A;@Inject&#x000A;private PartitionManager partitionManager;</pre> <p> You can also observe the <code>PartitionManagerCreateEvent</code> to initialize your partitions during application startup. As mentioned before, by default PicketLink will create a default partition if none is provided, but sometimes you may want to initialize your own partitions and don't create a default one: </p> <pre class="brush: java;">&#x000A;@Stateless&#x000A;public class IDMInitializer {&#x000A;&#x000A;  public void createDefaultUsers(@Observes PartitionManagerCreateEvent event) {&#x000A;    PartitionManager partitionManager = event.getPartitionManager();&#x000A;&#x000A;    createUserForRealm(partitionManager, Resources.REALM.acme.name(), "bugs");&#x000A;    createUserForRealm(partitionManager, Resources.REALM.umbrella.name(), "jill");&#x000A;    createUserForRealm(partitionManager, Resources.REALM.wayne.name(), "bruce");&#x000A;  }&#x000A;&#x000A;  private void createUserForRealm(PartitionManager partitionManager, String realmName, String loginName) {&#x000A;    Realm partition = partitionManager.getPartition(Realm.class, realmName);&#x000A;&#x000A;    if (partition == null) {&#x000A;      partition = new Realm(realmName);&#x000A;      partitionManager.add(partition);&#x000A;    }&#x000A;&#x000A;    IdentityManager identityManager = partitionManager.createIdentityManager(partition);&#x000A;    User user = new User(loginName);&#x000A;    Password password = new Password(user.getLoginName() + "123");&#x000A;&#x000A;    identityManager.add(user);&#x000A;    identityManager.updateCredential(user, password);&#x000A;  }&#x000A;&#x000A;}</pre> <p> This is a good example about how to use the <code>PartitionManager</code> bean to create different partitions and store different users for each one. </p> <p> The <code>PartitionManager</code> interface provides some key services to manage partitions as well create other key IDM components. In the example above it is being used to look for a <code>Realm</code> partition using a name: </p> <pre class="brush: java;">&#x000A;Realm partition = this.partitionManager.getPartition(Realm.class, realmName);</pre> <p> It is being used to create a new partition: </p> <pre class="brush: java;">&#x000A;this.partitionManager.add(partition);</pre> <p> And for last, we're also using it to create a <code>IdentityManager</code> instance for a specific partition so we can manage identity data such as users, credentials, roles and groups: </p> <pre class="brush: java;">&#x000A;IdentityManager identityManager = this.partitionManager.createIdentityManager(partition);</pre> <p> Another important aspect of Partition Management is that you can have different identity stores(eg.: LDAP and JPA) each one storing data for a specific partition. Take a look the this <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#Providing_Multiple_Configurations">documentation</a> for more information about how to store data using different partitions and identity stores. </p> <p> For more information about the the <code>PartitionManager</code> interface take a look at this <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Overview">documentation.</a> </p> <p> You can also check the <a href="https://github.com/pedroigor/picketlink-quickstarts/tree/master/picketlink-authentication-idm-multi-tenancy">PicketLink Multi-Tenancy Example</a> quickstart for more examples about how to use partitions. </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Managing Identity Types (Eg.: User, Roles and Groups)</h3> <p> If you look again at the Identity Model diagram, you'll notice that there is a <b>IdentityType</b> interface. This is the base interface for Identity objects. It declares properties that indicate whether the identity object is enabled or not, optional created and expiry dates, plus methods to read and set the owning Partition. Every single IdentityType is directly related with a specific partition. You should keep that in mind when storing them. </p> <p> Usually, the representation of users, roles and groups will always be based on the IdentityType interface. But you're not tied to represent only these, if you're working with a mobile application you may want to have a representation for user's devices (eg.: cell phones, tablets, etc) and create your own implementation of the IdentityType interface. </p> <p> The main component used to manage identity types is the <code>IdentityManager</code>. It is basically an interface with a lot of useful methods to give you complete control over your types such as: <ul> <li>CRUD operations</li> <li>Query</li> <li>Credential Management</li> </ul> </p> <p> The <code>IdentityManager</code> can always be injected into any bean as follows: </p> <pre class="brush: java;">&#x000A;@Inject&#x000A;private IdentityManager identityManager;</pre> <div class="well"> INFO: The <code>IdentityManager</code> bean is a request-scoped bean, it is not thread safe. Keep that in mind when injecting it into your beans. </div> <p> As mentioned before, the <code>IdentityManager</code> is directly related with a partition. Usually, when you inject this bean you're working in the scope of the default partition. But you may want to inject an instance using a different partition, specially if you're working in a multi-tenancy architecture. This can be easily done by just providing a producer method that returns the partition you want to use. </p> <pre class="brush: java;">&#x000A;@SessionScoped&#x000A;@Named&#x000A;public class RealmSelector implements Serializable {&#x000A;&#x000A;  @Inject&#x000A;  private PartitionManager partitionManager;&#x000A;&#x000A;  private Realm realm;&#x000A;&#x000A;  @Produces&#x000A;  @PicketLink&#x000A;  public Realm select() {&#x000A;    return this.realm;&#x000A;  }&#x000A;&#x000A;  public Resources.REALM getRealm() {&#x000A;    if (this.realm == null) {&#x000A;      return null;&#x000A;    }&#x000A;&#x000A;    return Resources.REALM.valueOf(this.realm.getName());&#x000A;  }&#x000A;&#x000A;  public void setRealm(Resources.REALM realm) {&#x000A;    this.realm = this.partitionManager.getPartition(Realm.class, realm.name());&#x000A;  }&#x000A;&#x000A;}</pre> <p> The code above is a good example about how you can set the current partition for a given user session. The following method </p> <pre class="brush: java;">&#x000A;public void setRealm(Resources.REALM realm) {&#x000A;  this.realm = this.partitionManager.getPartition(Realm.class, realm.name());&#x000A;}</pre> <p> is receiving a Enum value which maps to a specific partition supported by the application. Inside this method the <code>PartitionManager</code> interface is used to obtain the corresponding partition from the Identity Store and store it internally. Now, every time you inject a <code>IdentityManager</code> PicketLink will create one based on this partition. Look at this producer method: </p> <pre class="brush: java;">&#x000A;@Produces&#x000A;@PicketLink&#x000A;public Realm select() {&#x000A;  return this.realm;&#x000A;}</pre> <p> Here the <code>@PicketLink</code> qualifier annotation is used to indicate that PicketLink should use the returned partition for every single IDM operation. </p> <p> So far we have seem what is the IdentityManager, how it is related with your partitions and how to get an instance to start managing your identity types. However, we didn't talk about how to use it to store your identity types. The <code>IdentityManager</code> interface provides methods to CRUD your identity types and this is the easiest part. </p> <pre class="brush: java;">&#x000A;User user = new User("jdoe");&#x000A;&#x000A;user.setFirstName("Jane");&#x000A;user.setLastName("Doe");&#x000A;&#x000A;identityManager.add(user); // let's store user 'jdoe'&#x000A;&#x000A;Group group = new Group("employees");&#x000A;&#x000A;identityManager.add(group); // let's store group 'employees'&#x000A;&#x000A;Role admin = new Role("admin");&#x000A;&#x000A;identityManager.add(admin); // let's store role 'admin'</pre> <p> Simple isn't ? Is just a matter of instantiating your type, populate it with some data and use the <code>IdentityManager</code> to store it. The same applies when you're updating: </p> <pre class="brush: java;">&#x000A;User user = BasicModel.getUser(identityManager, "jdoe");&#x000A;&#x000A;user.setEmail("jdoe@jboss.org");&#x000A;&#x000A;identityManager.update(user); // let's update user's email</pre> <p> or removing: </p> <pre class="brush: java;">&#x000A;User user = BasicModel.getUser(identityManager, "jdoe");&#x000A;&#x000A;identityManager.remove(user); // let's remove user 'jdoe'</pre> <p> You may notice that in all examples above the <b> <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Basic_Identity_Model">BasicModel</b></a> class is being used. As discussed in the <b>Identity Model</b> section, PicketLink provides a default identity model implementation, which we call Basic Model. The BasicModel class is basically a utility class with a lot of useful methods to easily manage all types provided by the Basic Model. As you can see in the examples, we're using the <code>BasicModel.getUser</code> to retrieve an User instance from the identity store. If you're using the Basic Model in your application, you'll find this class very helpful. </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Managing Relationships (Eg.: Granting Roles, Group Membership, etc)</h3> <p> When designing your identity model, define only your identity types isn't enough. You also need to define how they relate with each other in a manner that you create some meaninful relationships between them. </p> <p> A good example of a relationship is when you need to grant a role to an user or add an user to a group, or even tell that an user plays a specific role in a group. This is what relationships is all about. </p> <p> The same way the Basic Model provides some built-in identity types ready for use, it also provides some common relationships types. Are they: <ul> <li><b>Grant</b> - used to grant a Role to an User or Group.</li> <li><b>GroupMembership</b> - used to add an user as a member of a group.</li> <li><b>GroupRole</b> - used to tell that an user plays a specific role in a group</li> </ul> </p> <p> These are very common cases of relationships from a security perspective. You usually need to define roles for users and groups, make an user member of a group or define a role for him inside a group. </p> <p> But again, you're not tied to use only those relationship types. The beauty of PicketLink is that you can even create your own relationships according with your requirements ! </p> <p> For more information about relationship types and how to create your own types, plese check our <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#Creating_Custom_Relationships">documentation.</a> </p> <p> The same way identity types are managed by the <code>IdentityManager</code> interface, relationships are managed by a specific interface called <code>RelationshipManager</code>. But differently than identity types, relationships don't belong to a specific partition. This is an important thing to keep in mind, actually they help to reference different identity types from different partitions. For example, you can store an user in Partition A and also have a Role in Partition B. It is possible to create a Grant relationship using both User and Role, even if they belong to different partitions ! </p> <p> That said, the <code>RelationshipManager</code> can also be inject into any of your beans as follows: </p> <pre class="brush: java;">&#x000A;@Inject&#x000A;private RelationshipManager relationshipManager;</pre> <p> Or you can create it manually from a <code>PartitionManager</code> instance as follows: </p> <pre class="brush: java;">&#x000A;RelationshipManager relationshipManager = this.partitionManager.createRelationshipManager();</pre> <p> Manage relationships using this interface is pretty simple, here are some examples: </p> <pre class="brush: java;">&#x000A;User bob = BasicModel.getUser(identityManager, "bob"); // let's retrieve user 'bob'&#x000A;Role superuser = BasicModel.getRole(identityManager, "superuser"); // let's retrieve role 'superuser'&#x000A;&#x000A;BasicModel.grantRole(relationshipManager, bob, superuser); // now grant role 'superuser' to 'bob'</pre> <p> You may notice that we're also using the BasicModel class to help us to create the relationship. But the above is equivalent to the following: </p> <pre class="brush: java;">&#x000A;User bob = BasicModel.getUser(identityManager, "bob");&#x000A;Role superuser = BasicModel.getRole(identityManager, "superuser");&#x000A;&#x000A;Grant grant = new Grant(bob, superuser);&#x000A;&#x000A;identityManager.add(grant);</pre> <p> For more information about how to manage relationships, please look at the <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#sect-Managing_Relationships">documentation.</a> </p> <p> If we want to check if a role was granted to an user we can just use: </p> <pre class="brush: java;">&#x000A;User bob = BasicModel.getUser(identityManager, "bob");&#x000A;Role superuser = BasicModel.getRole(identityManager, "superuser");&#x000A;&#x000A;BasicModel.hasRole(relationshipManager, bob, superuser);</pre> <p> Or we can use the Relationship Query API as follows: </p> <pre class="brush: java;">&#x000A;RelationshipQuery&lt;Grant&gt; query = relationshipManager.createRelationshipQuery(Grant.class);&#x000A;&#x000A;query.setParameter(Grant.ASSIGNEE, bob);&#x000A;query.setParameter(GroupRole.ROLE, superuser);&#x000A;&#x000A;List&lt;Grant&gt; result = query.getResultList();&#x000A;&#x000A;if (!result.isEmpty()) {&#x000A;  // we found a Grant for usser 'bob' and role 'superuser'&#x000A;}</pre> <p> You can even get all roles granted for an user: </p> <pre class="brush: java;">&#x000A;RelationshipQuery&lt;Grant&gt; query = relationshipManager.createRelationshipQuery(Grant.class);&#x000A;&#x000A;query.setParameter(Grant.ASSIGNEE, bob);&#x000A;&#x000A;List&lt;Grant&gt; result = query.getResultList();&#x000A;&#x000A;for (Grant grant : result) {&#x000A;  // iterating over the user roles&#x000A;}</pre> <p> For some very useful and working examples about how to use the Query API, take at look at those <a href="https://github.com/picketlink/picketlink/tree/master/modules/idm/tests/src/test/java/org/picketlink/test/idm/query">classes.</a> </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Managing Credentials and Authentication</h3> <p> PicketLink IDM provides a easy and flexible API that allows you to manage credentials and perform authentication. The Credential API is based on two main concepts: <ul> <li>Only <code>Account</code> types are passive of authentication.</li> <li>You can use any type of credential you want. However, PicketLink provides some built-in credential types for Username/Password, Time-based One Time Password (TOTP), DIGEST and X509 certificates.</li> </ul> </p> <p> If you look the Identity Model, you'll notice that there is a special interface called <code>Account</code>. It is the base interface for identities that are capable of authenticating. Since the authentication process may not depend on one particular type of attribute (not all authentication is performed with a username and password) there are no hard-coded property accessors defined by this interface. It is up to each application to define the Account implementations required according to the application's requirements. </p> <p> An example of Account type is the User type provided by the Basic Model. For the sake of this guide, we'll use the User type to demonstrate how to update and validate credentials. </p> <p> Credentials are also managed by the <code>IdentityManager</code> interface. The example below shows how you can use it to update the credentials for an user. </p> <pre class="brush: java;">&#x000A;User user = BasicModel.getUser(identityManager, "jsmith");&#x000A;Password password = new Password("abcd1234")&#x000A;&#x000A;identityManager.updateCredential(user, password); // let's update user's credential</pre> <p> Once the user has a credential, you can validate it and authenticate the user as follows: </p> <pre class="brush: java;">&#x000A;User user = BasicModel.getUser(identityManager, "jsmith");&#x000A;UsernamePasswordCredentials credential = new UsernamePasswordCredentials();&#x000A;Password password = new Password("abcd1234");&#x000A;&#x000A;credential.setUsername(user.getLoginName());&#x000A;credential.setPassword(password);&#x000A;&#x000A;identityManager.validateCredentials(credential);&#x000A;&#x000A;if (Status.VALID.equals(credential.getStatus()) {&#x000A;  // successful validation&#x000A;} else {&#x000A;  // invalid credentials&#x000A;}</pre> <p> Please check the <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Credential_Validation_and_Management">documentation</a> for more information about the built-in credential types and more details about the Credential API. There you will also find how to extend PicketLink and provide your own credential types. </p> <p> PicketLink also provides some useful quickstarts in this area: <ul> <li> <a href="https://github.com/jboss-developer/jboss-picketlink-quickstarts/tree/master/picketlink-authentication-two-factor">Time-based One Time Password Authentication</a> </li> </ul> </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Managing Attributes</h3> <p> PicketLink provides a nice way to manage attributes for identity model types. In another words, you can manage attributes for most of the supported types like partitions, identity types and relatinship types. </p> <p> Attributes are supported in two flavors: <ul> <li><b>Formal attributes</b> - Strong-typed and directly defined in your types as properties. Eg.: User.loginName, User.firstName, etc.</li> <li><b>Ad-hoc attributes</b> - Weak-typed and stored as key/value pairs.</li> </ul> </p> <p> When creating your own identity model types, you'll usually prefer formal attributes to store the state. In this case you just need to define a property in your type mapped with the <code>@AttributeProperty</code> annotation. </p> <p> But sometimes, you may need some flexibility on how attributes are created/updated/removed. So you don't need to change your types to support new attributes. Here is an example about how to set ad-hoc attributes to a type. </p> <pre class="brush: java;">&#x000A;User user = BasicModel.getUser(identityManager, "jsmith");&#x000A;&#x000A;user.setAttribute(new Attribute&lt;Integer&gt;("QuestionTotal", 2));&#x000A;user.setAttribute(new Attribute&lt;String&gt;("Question1", "What is favorite toy?"));&#x000A;user.setAttribute(new Attribute&lt;String&gt;("Question1Answer", "Gum"));&#x000A;user.setAttribute(new Attribute&lt;String&gt;("Question2", "What is favorite word?"));&#x000A;user.setAttribute(new Attribute&lt;String&gt;("Question2Answer", "Hi"));&#x000A;&#x000A;identityManager.update(user);</pre> <p> However, you should use ad-hoc attributes very wisely as they're not type-safe. </p> <p> PicketLink also supports queries based on attributes. What mean you can find a specific type by providing the attribute name and value you want to match. </p> <p> For more information about Attribute Management, check our <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Attribute_Management">documentation.</a> </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Configuration Overview</h3> <p> When using Java JEE you need a minimal configuration to start using PicketLink IDM in your application. PicketLink provides some defaults if you want to use a File-based or JPA-based configuration. In both cases, PicketLink will always use the Basic Model as the default identity model. </p> <h4>File-based Default Configuration</h4> <p> A File-based configuration is very handy for demos, development and testing purposes, it allows you to start using PicketLink very quickly. This configuration is enabled when your application does not provide a IDM configuration and when no JPA Entity classes are found in your application's classpath mapped with the PicketLink JPA Annotations. </p> <p> This <a href="https://github.com/jboss-developer/jboss-picketlink-quickstarts/tree/master/picketlink-authentication-idm-jsf">quickstart</a> is a good example about how an application looks like when using the File-based default configuration. </p> <h4>JPA-based Default Configuration</h4> <p> The JPA-based configuration is enabled when JPA Entity classes are found in your application's classpath mapped with the PicketLink JPA Annotations. The good news is that PicketLink provides a set of JPA entities which can be used with the Basic Model. Those entities provide all the necessary mapping to store the Basic Model types. </p> <p> To get those entities in your project you just need to add the following dependency to your pom.xml: </p> <pre class="brush: xml;">&#x000A;&lt;dependency&gt;&#x000A;  &lt;groupId&gt;org.picketlink&lt;/groupId&gt;&#x000A;  &lt;artifactId&gt;picketlink-idm-simple-schema&lt;/artifactId&gt;&#x000A;  &lt;scope&gt;runtime&lt;/scope&gt;&#x000A;&lt;/dependency&gt;</pre> <p> You should also provide a producer to the <b>EntityManager</b> you want to use. </p> <pre class="brush: java;">&#x000A;@PersistenceContext&#x000A;@Produces&#x000A;private EntityManager picketlinkEntityManager;</pre> <p> When using JPA, if you have a single <code>EntityManager</code> in your application you can produce it just like above. However, if you have multiple ones you must annotate the producer with the <code>@PicketLink</code> qualifier. </p> <p> It is important to highlight that the JPA entity classes provided by <b>picketlink-idm-simple-schema</b> are just a default mapping for the Basic Model. You're not forced to use it, the same way you're not forced to use the Basic Model. Actually, we strongly recommend users to design their own identity model (probably using the Basic Model as an example) and also use the picketlink-idm-simple-schema as an example about how to map your identity model types using JPA. </p> <div class="well"> Take a look at the <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Working_with_JPA">JPA Identity Store</a> documentation for more details. </div> <h4>Providing Your Own Configuration</h4> <p> All configuration is done during your application startup, where PicketLink provides some hooks that can be used to provide your own IDM configuration. Configure IDM is pretty simple, you'll usually use a fluent Configuration API from where you can provide your own configuration. </p> <p> One of this hooks is provided by the <code>IdentityConfigurationEvent</code>. This event is fired during your application startup and allows you to get a reference to the <code>IdentityConfigurationBuilder</code> from where you can provide your configuration. </p> <pre class="brush: java;">&#x000A;public static class IDMConfiguration {&#x000A;&#x000A;  public void observeIdentityConfigurationEvent(@Observes IdentityConfigurationEvent event) throws Exception {&#x000A;    IdentityConfigurationBuilder builder = event.getConfig();&#x000A;&#x000A;    builder&#x000A;      .named("custom-config")&#x000A;        .stores()&#x000A;          .jpa()&#x000A;            .supportAllFeatures();&#x000A;  }&#x000A;}</pre> <p> In the example above we're configuring IDM to use a JPA-based identity store, so you can store your identity data using a database. </p> <p> You can also provide your IDM configuration by producing one or more <code>IdentityConfiguration</code> instances: </p> <pre class="brush: java;">&#x000A;@Produces&#x000A;public IdentityConfiguration produceFileConfiguration() {&#x000A;  IdentityConfigurationBuilder builder = new IdentityConfigurationBuilder();&#x000A;&#x000A;  builder&#x000A;    .named("file-based.config")&#x000A;      .stores()&#x000A;        .file()&#x000A;          .supportAllFeatures();&#x000A;&#x000A;  return builder.build();&#x000A;}</pre> <p> Or you can even produce your own <code>PartitionManager</code> instance. </p> <pre class="brush: java;">&#x000A;@PicketLink&#x000A;@Produces&#x000A;public PartitionManager producePartitionManager() {&#x000A;  IdentityConfigurationBuilder builder = new IdentityConfigurationBuilder();&#x000A;&#x000A;  builder&#x000A;    .named("ldap.config")&#x000A;      .stores()&#x000A;        .ldap()&#x000A;          .baseDN("dc=jboss,dc=org")&#x000A;          .bindDN("uid=admin,ou=system")&#x000A;          .bindCredential("passwd")&#x000A;          .url("ldap://localhost:389")&#x000A;          .mapping(Agent.class)&#x000A;            .baseDN("ou=Agent,dc=jboss,dc=org")&#x000A;            .objectClasses("account")&#x000A;            .attribute("loginName", "uid", true)&#x000A;            .readOnlyAttribute("createdDate", "createTimeStamp")&#x000A;          .mapping(User.class)&#x000A;            .baseDN("ou=User,dc=jboss,dc=org")&#x000A;            .objectClasses("inetOrgPerson", "organizationalPerson")&#x000A;            .attribute("loginName", "uid", true)&#x000A;            .attribute("firstName", "cn")&#x000A;            .attribute("lastName", "sn")&#x000A;            .attribute("email", EMAIL)&#x000A;            .readOnlyAttribute("createdDate", "createTimeStamp")&#x000A;          .mapping(Role.class)&#x000A;            .baseDN("ou=Roles,dc=jboss,dc=org")&#x000A;            .objectClasses("role")&#x000A;            .attribute("name", "cn", true)&#x000A;            .readOnlyAttribute("createdDate", "createTimeStamp")&#x000A;          .mapping(Group.class)&#x000A;            .hierarchySearchDepth(4)&#x000A;            .objectClasses("group")&#x000A;            .attribute("name", "cn", true)&#x000A;            .readOnlyAttribute("createdDate", "createTimeStamp")&#x000A;            .parentMembershipAttributeName("member")&#x000A;          .mapping(Grant.class)&#x000A;            .forMapping(Role.class)&#x000A;            .attribute("assignee", "member")&#x000A;          .mapping(GroupMembership.class)&#x000A;            .forMapping(Group.class)&#x000A;            .attribute("member", "member");&#x000A;&#x000A;  return new DefaultPartitionManager(builder.buildAll());&#x000A;}</pre> <p> Please take a look at the <a href="http://docs.jboss.org/picketlink/2/latest/reference/html-single/#chap-Identity_Management_-_Configuration">Identity Configuration</a> section for more details about the Configuration API and the IDM configuration. </p> </div> </div> <div class="row-fluid"> <div class="span12"> <h3>Summary</h3> <p> Hopefully this guide helped you to understand some core concepts of PicketLink IDM like the <b>Identity Model</b>, <code>PartitionManager</code> and <code>IdentityManager</code> beans, what are the key features and references about how to extend PicketLink to fit your needs. </p> <p> We covered some important and basic concepts that will help you to deep dive into some more advanced concepts of PicketLink and create more advanced and complex usecases. </p> <p> Most of the things we covered in this guide are also demonstrated by the quickstarts, from where you can get much more usage examples considering different usecases. </p> <p> Fell free to contribute with your own guides and help us to improve PicketLink ! Enjoy it ! </p> </div> </div> </div> </div> </div> </div> <footer class="container"> <div class="row-fluid"> <div class="span2 offset1"> <h4>Navigate</h4> <ul> <li> <a href="http://picketlink.org/about/" title="About">About</a> </li> <li> <a href="http://picketlink.org/gethelp/" title="Get Help">Get Help</a> </li> <li> <a href="https://community.jboss.org/en/picketlink?view=discussion" title="Forums">Forums</a> </li> <li> <a href="http://picketlink.org/gettingstarted/" title="Download">Download</a> </li> </ul> </div> <div class="span2"> <h4>Follow Us</h4> <ul> <li> <a href="https://twitter.com/picketlink" title="Twitter">Twitter</a> </li> <li> <a href="https://plus.google.com/s/Picketlink" title="Google+">Google+</a> </li> </ul> </div> <div class="span2"> <h4>Contribute</h4> <ul> <li> <a href="https://issues.jboss.org/browse/PLINK" title="Submit a bug">Submit a bug</a> </li> <li> <a href="https://github.com/picketlink/picketlink/fork" title="Fork">Fork The Code</a> </li> <li> <a href="http://picketlink.org/joinus/" title="Join Us">Join Us</a> </li> </ul> </div> <div class="span3 offset1"> <h4>Apache 2.0 License</h4> <p>All dependencies of this project are available under the ASLv2 or a compatible license.</p> </div> </div> <div class="row-fluid"> <div class="span6 offset1"> <p style="margin-top: 5px; font-size: 80%;"> © Copyright 2013 Red Hat, Inc. <br/> <i class="icon-fire"></i> Made with <a href="https://github.com/jbossorg/bootstrap-community" style="text-decoration: underline;">JBoss Community Bootstrap</a> and <a href="http://awestruct.org/" style="text-decoration: underline;">Awestruct</a> <br/> <i class="icon-globe"></i> This website is open source! If you want to improve it, <a href="https://github.com/picketlink/web-picketlink.org" style="text-decoration: underline;">fork the project,</a> and send a pull request. <br/> <i class="icon-share"></i> Website released under <a href="http://creativecommons.org/licenses/by/3.0/" style="text-decoration: underline;">CC BY 3.0.</a> </p> </div> <div class="span3 offset1"> <div class="jbossbadge"> <a href="http://www.jboss.org/"> <img src="http://static.jboss.org/theme/images/common/jbossbadge.png"/> </a> </div> </div> </div> </footer> <div class="container" id="companyfooter"> <div class="redhatlogo"> <div id="logospacer"></div> <a href="http://www.redhat.com/"><img src="http://static.jboss.org/theme/images/common/redhat_logo.png"/></a> </div> </div> <span class="backToTop"> <a href="#top">back to top</a> </span> <script src="http://picketlink.org/css/bootstrap-community.min.js"></script> <script type='text/javascript' language='JavaScript' src='http://www.redhat.com/j/elqNow/elqCfg.js'></script> <script type='text/javascript' language='JavaScript' src='http://www.redhat.com/j/elqNow/elqImg.js'></script> <div id="oTags"> <script type="text/javascript" src="//www.redhat.com/j/s_code.js"></script> <script type="text/javascript"><!--
      var coreUrl = encodeURI(document.URL.split("?")[0]).replace(/-/g," ");
      var urlSplit = coreUrl.toLowerCase().split(/\//);
      var urlLast = urlSplit[urlSplit.length-1];
      var pageNameString = "";
      var siteName = "";
      var minorSectionIndex = 3
      if (urlLast == "") {
          urlSplit.splice(-1,1);
      }
      if (urlLast.search(/\./) >= 0) {
          if (urlLast == "index.html") {
              urlSplit.splice(-1,1);
          }
          else {
              urlSplit[urlSplit.length-1] = urlLast.split(".").splice(0,1);
          }
      }
      siteName = urlSplit[2].split(".")[1];
      s.prop14 = s.eVar27 = siteName || "";
      s.prop15 = s.eVar28 = urlSplit[minorSectionIndex] || "";
      s.prop16 = s.eVar29 = urlSplit[minorSectionIndex+1] || "";
      pageNameString = urlSplit.splice(3).join(" | ");
      s.pageName = "jboss | community | " + siteName + " | " + pageNameString;
      s.server = "jboss";
      s.channel = "jboss | community";
      s.prop4 = s.eVar23 = encodeURI(document.URL);
      s.prop21 = s.eVar18 = coreUrl;
      s.prop2 = s.eVar22 = "en";
      s.prop3 = s.eVar19 = "us";
      //--></script> <script type="text/javascript" src="//www.redhat.com/j/rh_omni_footer.js"></script> <script language="JavaScript" type="text/javascript"><!--
      if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
      //--></script> <noscript><a href="http://www.omniture.com" title="Web Analytics"><img src="https://smtrcs.redhat.com/b/ss/redhatcom,redhatglobal/1/H.25.4--NS/0?[AQB]&cdp=3&[AQE]" height="1" width="1" border="0" alt=""/></a></noscript> </div> <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script> <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-46906810-1");
    pageTracker._trackPageview();
    } catch(err) {}</script> </body> </html>